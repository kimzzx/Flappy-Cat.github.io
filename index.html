<!doctype html>
<html lang="th" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Flappy Cat ğŸ±ğŸ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    body { box-sizing: border-box; }
    * { font-family: 'Kanit', sans-serif; }

    @keyframes float {
      0%,100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    @keyframes sparkle {
      0%,100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.7; transform: scale(1.2); }
    }
    .cat-float { animation: float 1.5s ease-in-out infinite; }
    .fruit-sparkle { animation: sparkle 0.8s ease-in-out infinite; }

    .game-bg-playing {
      background-image: url('https://drive.google.com/thumbnail?id=190VZ-Nrg10S9mr46wLxKC4Dd-EUuqFcD&sz=s800');
      background-size: cover;
      background-position: center;
    }
  </style>
</head>

<body class="h-full m-0 p-0 overflow-hidden">
<div id="app" class="w-full h-full relative">

<!-- START SCREEN -->
<div id="startScreen" class="w-full h-full flex flex-col items-center justify-center bg-gradient-to-b from-pink-200 via-pink-100 to-rose-100">
  <div class="text-center">
    <div class="text-8xl mb-4 cat-float">ğŸ±</div>
    <h1 id="gameTitle" class="text-5xl font-bold text-pink-600 mb-2 drop-shadow-lg">Flappy Cat</h1>
    <p class="text-xl text-pink-500 mb-8">ğŸğŸŠğŸ‹ à¹€à¸à¹‡à¸šà¸œà¸¥à¹„à¸¡à¹‰à¹ƒà¸«à¹‰à¹„à¸”à¹‰à¸¡à¸²à¸à¸—à¸µà¹ˆà¸ªà¸¸à¸”! ğŸ‡ğŸ“ğŸ‘</p>

    <div class="bg-white/70 rounded-3xl p-6 mx-4 mb-8 shadow-xl border-4 border-pink-300">
      <h2 class="text-2xl font-bold text-pink-600 mb-4">ğŸ® à¸§à¸´à¸˜à¸µà¹€à¸¥à¹ˆà¸™</h2>
      <div class="text-left text-pink-700 space-y-2">
        <p>ğŸ¾ à¹à¸•à¸°à¸«à¸™à¹‰à¸²à¸ˆà¸­à¹€à¸à¸·à¹ˆà¸­à¹ƒà¸«à¹‰à¹à¸¡à¸§à¸šà¸´à¸™à¸‚à¸¶à¹‰à¸™</p>
        <p>âœ… à¹€à¸à¹‡à¸šà¸œà¸¥à¹„à¸¡à¹‰à¸—à¸µà¹ˆà¸•à¸£à¸‡à¸à¸±à¸šà¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢ = à¹„à¸”à¹‰à¸„à¸°à¹à¸™à¸™</p>
        <p>âŒ à¹€à¸à¹‡à¸šà¸œà¸´à¸”à¸›à¸£à¸°à¹€à¸ à¸— = à¹€à¸ªà¸µà¸¢à¸«à¸±à¸§à¹ƒà¸ˆ</p>
        <p>ğŸ’” à¸«à¸±à¸§à¹ƒà¸ˆà¸«à¸¡à¸” 3 à¸”à¸§à¸‡ = à¹€à¸à¸¡à¹‚à¸­à¹€à¸§à¸­à¸£à¹Œ</p>
      </div>
    </div>

    <div id="highScoreSection" class="hidden bg-yellow-100/80 rounded-2xl px-6 py-3 mb-6 shadow-lg border-4 border-yellow-400">
      <p class="text-yellow-700 font-bold text-lg">
        ğŸ† à¸„à¸°à¹à¸™à¸™à¸ªà¸¹à¸‡à¸ªà¸¸à¸”: <span id="mainHighScore" class="text-3xl text-yellow-600">0</span>
      </p>
    </div>

    <button id="startBtn"
      class="bg-gradient-to-r from-pink-500 to-rose-500 text-white text-2xl font-bold py-4 px-12 rounded-full shadow-2xl border-4 border-white">
      ğŸ® à¹€à¸£à¸´à¹ˆà¸¡à¹€à¸à¸¡!
    </button>
  </div>
</div>

<!-- GAME SCREEN -->
<div id="gameScreen" class="hidden w-full h-full relative game-bg-playing">
  <div class="absolute inset-0 bg-black/20"></div>

  <div class="absolute top-4 left-4 right-4 flex justify-between z-20">
    <div class="bg-white/90 rounded-2xl px-6 py-3 border-4 border-pink-400">
      à¸„à¸°à¹à¸™à¸™: <span id="score" class="text-3xl font-bold">0</span>
    </div>

    <div class="bg-white/90 rounded-2xl px-6 py-3 border-4 border-yellow-400">
      à¹€à¸à¹‡à¸š: <span id="targetFruit" class="text-4xl">ğŸ</span>
    </div>

    <div class="bg-white/90 rounded-2xl px-6 py-3 border-4 border-red-400">
      <span id="lives" class="text-3xl">â¤ï¸â¤ï¸â¤ï¸</span>
    </div>
  </div>

  <div id="gameArea" class="w-full h-full relative z-10">
    <div id="cat" class="absolute text-6xl" style="left:15%;top:50%">ğŸ±</div>
    <div id="fruitsContainer" class="absolute inset-0"></div>
  </div>
</div>

<!-- GAME OVER -->
<div id="gameOverScreen" class="hidden w-full h-full flex items-center justify-center bg-gradient-to-b from-purple-200 via-pink-200 to-rose-200">
  <div class="text-center">
    <div class="text-7xl mb-4">ğŸ˜¿</div>
    <h2 class="text-5xl font-bold text-pink-600 mb-4">à¹€à¸à¸¡à¹‚à¸­à¹€à¸§à¸­à¸£à¹Œ!</h2>

    <div class="bg-white/80 rounded-3xl p-8 mb-8 border-4 border-pink-300">
      <p class="text-2xl mb-2">à¸„à¸°à¹à¸™à¸™à¸‚à¸­à¸‡à¸„à¸¸à¸“</p>
      <p id="finalScore" class="text-6xl font-bold">0</p>
      <p>ğŸ† à¸„à¸°à¹à¸™à¸™à¸ªà¸¹à¸‡à¸ªà¸¸à¸”: <span id="highScore">0</span></p>
    </div>

    <button id="restartBtn"
      class="bg-gradient-to-r from-purple-500 to-pink-500 text-white text-2xl font-bold py-4 px-12 rounded-full border-4 border-white">
      ğŸ”„ à¹€à¸¥à¹ˆà¸™à¸­à¸µà¸à¸„à¸£à¸±à¹‰à¸‡
    </button>
  </div>
</div>

</div>

<script>
const FRUITS = ['ğŸ','ğŸŠ','ğŸ‹','ğŸ‡','ğŸ“','ğŸ‘','ğŸ¥','ğŸ’'];
const GRAVITY = 0.4;
const JUMP_FORCE = -8;
const FRUIT_SPEED = 3;

let gameState = {
  isPlaying:false,
  score:0,
  lives:3,
  catY:50,
  catVelocity:0,
  fruits:[],
  targetFruit:null
};

const startScreen = document.getElementById('startScreen');
const gameScreen = document.getElementById('gameScreen');
const gameOverScreen = document.getElementById('gameOverScreen');
const startBtn = document.getElementById('startBtn');
const restartBtn = document.getElementById('restartBtn');
const cat = document.getElementById('cat');
const scoreDisplay = document.getElementById('score');
const livesDisplay = document.getElementById('lives');
const targetFruitDisplay = document.getElementById('targetFruit');
const fruitsContainer = document.getElementById('fruitsContainer');
const finalScoreDisplay = document.getElementById('finalScore');
const highScoreDisplay = document.getElementById('highScore');

function startGame(){
  gameState = {...gameState,isPlaying:true,score:0,lives:3,catY:50,catVelocity:0,fruits:[]};
  selectNewTargetFruit();
  updateDisplay();
  fruitsContainer.innerHTML='';
  startScreen.classList.add('hidden');
  gameOverScreen.classList.add('hidden');
  gameScreen.classList.remove('hidden');
  requestAnimationFrame(gameLoop);
  setInterval(spawnFruit,1200);
}

function selectNewTargetFruit(){
  gameState.targetFruit = FRUITS[Math.floor(Math.random()*FRUITS.length)];
  targetFruitDisplay.textContent = gameState.targetFruit;
}

function spawnFruit(){
  if(!gameState.isPlaying) return;
  const fruit = {
    emoji:FRUITS[Math.floor(Math.random()*FRUITS.length)],
    x:100,
    y:10+Math.random()*70,
    id:Date.now()+Math.random()
  };
  gameState.fruits.push(fruit);

  const el = document.createElement('div');
  el.id = `fruit-${fruit.id}`;
  el.className='absolute text-5xl fruit-sparkle';
  el.textContent=fruit.emoji;
  el.style.left=`${fruit.x}%`;
  el.style.top=`${fruit.y}%`;
  fruitsContainer.appendChild(el);
}

function jump(){
  if(gameState.isPlaying) gameState.catVelocity = JUMP_FORCE;
}

function gameLoop(){
  if(!gameState.isPlaying) return;

  gameState.catVelocity += GRAVITY;
  gameState.catY += gameState.catVelocity*0.5;
  gameState.catY = Math.max(5,Math.min(85,gameState.catY));

  cat.style.top = `${gameState.catY}%`;
  cat.style.transform = `rotate(${gameState.catVelocity*3}deg)`;

  gameState.fruits.forEach((fruit,i)=>{
    fruit.x -= FRUIT_SPEED*0.3;
    const el = document.getElementById(`fruit-${fruit.id}`);
    if(el) el.style.left=`${fruit.x}%`;

    if(Math.abs(fruit.x-15)<8 && Math.abs(fruit.y-gameState.catY)<10){
      if(fruit.emoji===gameState.targetFruit){
        gameState.score+=10;
        selectNewTargetFruit();
      }else{
        gameState.lives--;
      }
      el.remove();
      gameState.fruits.splice(i,1);
      updateDisplay();
      if(gameState.lives<=0) endGame();
    }
  });

  requestAnimationFrame(gameLoop);
}

function updateDisplay(){
  scoreDisplay.textContent=gameState.score;
  livesDisplay.textContent='â¤ï¸'.repeat(gameState.lives)+'ğŸ–¤'.repeat(3-gameState.lives);
}

function endGame(){
  gameState.isPlaying=false;
  finalScoreDisplay.textContent=gameState.score;
  highScoreDisplay.textContent=gameState.score;
  gameScreen.classList.add('hidden');
  gameOverScreen.classList.remove('hidden');
}

startBtn.onclick=startGame;
restartBtn.onclick=startGame;
gameScreen.onclick=jump;
document.onkeydown=e=>{if(e.code==='Space'||e.code==='ArrowUp')jump();}
</script>

</body>
</html>
